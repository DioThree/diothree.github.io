<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pencatatan Stok Barang</title>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            overflow: hidden;
        }
        header {
            background-color: #007bff;
            color: white;
            padding: 20px;
            text-align: center;
        }
        h1 {
            margin: 0;
            font-size: 1.8em;
        }
        main {
            padding: 25px;
        }
        
        /* === GAYA BARU UNTUK DAFTAR INPUT === */
        #daftar-input-container {
            margin-bottom: 20px;
            /* Kita beri batas tinggi dan scroll jika daftarnya sangat panjang */
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 5px;
        }
        #daftar-input-barang {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .item-input-row {
            display: flex; /* Membuat label dan input sejajar */
            justify-content: space-between; /* Mendorong label ke kiri, input ke kanan */
            align-items: center; /* Menjaga agar tetap sebaris vertikal */
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        /* Memberi ruang untuk nama barang */
        .item-input-row label {
            flex-grow: 1; /* Ambil sisa ruang yang ada */
            margin-right: 15px;
            font-weight: 500;
        }
        /* Mengatur ukuran kotak input Kg */
        .item-input-row .input-kg {
            width: 90px;
            flex-shrink: 0; /* Jangan biarkan kotak input mengecil */
            padding: 8px;
            font-size: 0.95em;
            text-align: right;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        /* === AKHIR GAYA BARU === */

        .tombol {
            display: inline-block;
            background-color: #007bff;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            width: 100%;
            text-align: center;
            margin-top: 10px;
        }
        .tombol:hover {
            background-color: #0056b3;
        }
        .tombol-laporan {
            background-color: #28a745; 
        }
        .tombol-laporan:hover {
            background-color: #1e7e34;
        }
        #area-laporan {
            margin-top: 20px;
            background-color: #f9f9f9;
            border: 1px dashed #ddd;
            border-radius: 5px;
            padding: 20px;
            min-height: 100px;
            white-space: pre-wrap; 
            font-family: "Courier New", Courier, monospace;
        }
        #status-update {
            text-align: center;
            padding: 10px;
            margin-top: 15px;
            border-radius: 5px;
            font-weight: 500;
        }
        .status-sukses {
            background-color: #e6ffed;
            color: #228b22;
        }
        .status-error {
            background-color: #ffebee;
            color: #c62828;
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>üìù Input Stok Barang</h1>
        </header>
        
        <main>
            <label style="font-weight: 600; display: block; margin-bottom: 10px;">Daftar Barang (Isi Stok dalam Kg):</label>
            
            <div id="daftar-input-container">
                <ul id="daftar-input-barang">
                    </ul>
            </div>
            <button id="tombol-update" class="tombol">Update Semua Stok</button>
            
            <div id="status-update" style="display: none;"></div> 

            <hr style="border: 0; border-top: 1px solid #eee; margin: 25px 0;">

            <button id="tombol-laporan" class="tombol tombol-laporan">Tampilkan Laporan Stok</button>
            
            <div id="area-laporan">
                Laporan stok (hanya barang > 0 Kg) akan muncul di sini...
            </div>
            
        </main>
    </div>

    <script>
        // --- 1. Definisi Data ---
        
        // Daftar nama barang (tidak berubah)
        const daftarNamaBarang = [
            "Bawang Merah", "Bawang Putih", "Bombay", "Bawang Sumenep", "Jengkol", "Jengkol Cangkang",
            "Wortel Dus", "Wortel AB", "Wortel PL", "Kentang AB", "Kentang PL", "Kentang AL", "Kentang ABC",
            "Cengek ORI", "Cengek Japlak", "Keriting Merah", "Keriting Hijau", "Genot", "Cabe Hijau", "Cabe Merah",
            "Daun Salam", "Sereh", "Daun Jeruk", "Laja", "Jahe", "Cikur", "Kunyit", "Lemon Kalifornia", "Lemon Biasa",
            "Jeruk Nipis", "Jeruk Purut", "Kol", "Seladah Bokor", "Tomat Merah", "Tomat Hijau", "Bonteng",
            "Bawang Daun", "Seledri", "Jagong", "Pecay", "Burkol", "Burkoli", "Pakcoy", "Lobak Kecil", "Lobak Daun",
            "Waluh Baby", "Waluh Daun", "Paria", "Lember", "Lenca", "Kacang Panjang", "Buncis",
            "Terong Ungu", "Terong Coel", "Oyong"
        ];
        
        // Objek untuk menyimpan stok (tidak berubah)
        let stokBarangKg = {};

        // --- 2. Referensi Elemen HTML ---
        
        // Kita ganti referensi dropdown & input tunggal
        // menjadi referensi ke 'daftar-input-barang' (ul)
        const daftarInputUl = document.getElementById('daftar-input-barang');
        
        const tombolUpdate = document.getElementById('tombol-update');
        const tombolLaporan = document.getElementById('tombol-laporan');
        const areaLaporan = document.getElementById('area-laporan');
        const statusBar = document.getElementById('status-update');

        // --- 3. Fungsi Inisialisasi (Dijalankan saat halaman dimuat) ---
        
        document.addEventListener('DOMContentLoaded', () => {
            
            // ================= PERUBAHAN LOGIKA DI SINI =================
            // Kita tidak lagi mengisi dropdown.
            // Kita mengisi 'daftarInputUl' (<ul>) dengan <li> untuk setiap barang.
            
            daftarNamaBarang.sort(); // Urutkan nama barang

            // Loop untuk setiap nama barang
            daftarNamaBarang.forEach(namaBarang => {
                
                if (namaBarang) { 
                    // 1. Masukkan ke objek stok dengan nilai awal 0
                    stokBarangKg[namaBarang] = 0;
                    
                    // 2. Buat elemen HTML untuk baris input
                    
                    // Buat <li> (baris)
                    const li = document.createElement('li');
                    li.className = 'item-input-row';
                    
                    // Buat <label> (Nama Barang)
                    const label = document.createElement('label');
                    const inputId = 'input-' + namaBarang.replace(/ /g, '-'); // Buat ID unik (cth: input-Bawang-Merah)
                    label.htmlFor = inputId;
                    label.textContent = namaBarang;
                    
                    // Buat <input> (Kotak Kg)
                    const input = document.createElement('input');
                    input.type = 'number';
                    input.id = inputId;
                    input.className = 'input-kg';
                    input.placeholder = 'Kg';
                    input.step = '0.1';
                    // Kita simpan nama barang di 'data-nama-barang'
                    // Ini SANGAT PENTING untuk menghubungkan input ke nama barang
                    input.dataset.namaBarang = namaBarang; 
                    
                    // 3. Masukkan label dan input ke dalam li
                    li.appendChild(label);
                    li.appendChild(input);
                    
                    // 4. Masukkan li ke dalam <ul>
                    daftarInputUl.appendChild(li);
                }
            });
            // ================= AKHIR PERUBAHAN =================
            
            console.log("Sistem Stok Siap. Objek stok:", stokBarangKg);
        });

        // --- 4. Fungsi-Fungsi Logika ---

        // ================= FUNGSI UPDATE STOK (LOGIKA BARU) =================
        function updateStok() {
            // 1. Ambil SEMUA input yang ada di dalam daftar
            const semuaInput = document.querySelectorAll('#daftar-input-barang .input-kg');
            
            let itemDiupdate = 0;
            
            // 2. Loop (ulangi) satu per satu input
            semuaInput.forEach(input => {
                // 3. Ambil nama barang dari 'data-nama-barang' yang kita simpan
                const namaBarang = input.dataset.namaBarang;
                
                // 4. Ambil nilai dari kotak input
                const nilaiInput = input.value;
                
                // 5. LOGIKA UPDATE:
                // Kita hanya update jika kotaknya DIISI ANGKA (termasuk 0)
                // Jika kotaknya dikosongkan (nilaiInput === ""), kita abaikan
                // Ini mencegah stok yang sudah ada terhapus jadi 0 jika kita tidak sengaja
                // mengosongkan kotaknya.
                
                if (nilaiInput !== "") {
                    const jumlahKg = parseFloat(nilaiInput);
                    
                    if (!isNaN(jumlahKg) && jumlahKg >= 0) {
                        // Jika angkanya valid, update objek stok
                        stokBarangKg[namaBarang] = jumlahKg;
                        itemDiupdate++;
                    } else if (nilaiInput !== "") {
                        // Jika diisi tapi bukan angka (cth: "abc")
                        console.warn(`Input tidak valid untuk [${namaBarang}]: ${nilaiInput}`);
                    }
                }
            });

            // 6. Beri notifikasi sukses
            tampilkanStatus(`‚úÖ STOK DIPERBARUI: ${itemDiupdate} item telah di-update.`, "sukses");

            // 7. Hapus SEMUA nilai di kotak input agar siap untuk input berikutnya
            semuaInput.forEach(input => {
                input.value = "";
            });
        }
        // ================= AKHIR FUNGSI UPDATE STOK =================


        // Fungsi tampilkanLaporan (TIDAK BERUBAH SAMA SEKALI)
        function tampilkanLaporan() {
            let laporanHTML = "--- LAPORAN STOK GUDANG (Kg) ---\n\n";
            let totalItem = 0;
            let totalKg = 0;
            let adaStok = false;

            const namaTersortir = Object.keys(stokBarangKg).sort();

            namaTersortir.forEach(nama => {
                const jumlah = stokBarangKg[nama];
                
                if (jumlah > 0) {
                    laporanHTML += `[${nama}]: ${jumlah} Kg\n`;
                    totalItem += 1;
                    totalKg += jumlah;
                    adaStok = true;
                }
            });

            if (!adaStok) {
                laporanHTML += "Belum ada barang yang memiliki stok (semua masih 0 Kg).";
            } else {
                laporanHTML += "\n-----------------------------------\n";
                laporanHTML += `Total Jenis Item (ada stok): ${totalItem}\n`;
                laporanHTML += `Total Berat Stok (Keseluruhan): ${totalKg.toFixed(2)} Kg`;
            }
            areaLaporan.textContent = laporanHTML;
        }

        // Fungsi tampilkanStatus (TIDAK BERUBAH)
        function tampilkanStatus(pesan, tipe) {
            statusBar.textContent = pesan;
            statusBar.className = (tipe === "sukses") ? "status-sukses" : "status-error";
            statusBar.style.display = "block"; 

            setTimeout(() => {
                statusBar.style.display = "none";
            }, 3000);
        }

        // --- 5. Menghubungkan Tombol ke Fungsi ---
        
        tombolUpdate.addEventListener('click', updateStok);
        tombolLaporan.addEventListener('click', tampilkanLaporan);
        
    </script>

</body>
</html>
